<!DOCTYPE html>
<html lang="en" data-theme="lofi">
  <head>
    <!-- Global Metadata --><meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="icon" type="image/svg+xml" href="/fav.png">
<meta name="generator" content="Astro v2.2.1">

<!-- Primary Meta Tags -->
<title>Como hakearon las llaves privadas de un amigo directamente de Metamask y que hacer para que no te ocurra.</title>
<meta name="title" content="Como hakearon las llaves privadas de un amigo directamente de Metamask y que hacer para que no te ocurra.">
<meta name="description" content="Resulta que hoy en la noche estamos en la comunidad conversando y de momento uno de los miembros...">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://manuelernestog.github.io/blog/como-hakearon-las-llaves-privadas/">
<meta property="og:title" content="Como hakearon las llaves privadas de un amigo directamente de Metamask y que hacer para que no te ocurra.">
<meta property="og:description" content="Resulta que hoy en la noche estamos en la comunidad conversando y de momento uno de los miembros...">
<meta property="og:image" content="https://images.ecency.com/DQmUytfbt6r8qGgvKhBLQwehcj7aPA23VVuFXQk8PHq95Gw/istock_962366210.png">

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://manuelernestog.github.io/blog/como-hakearon-las-llaves-privadas/">
<meta property="twitter:title" content="Como hakearon las llaves privadas de un amigo directamente de Metamask y que hacer para que no te ocurra.">
<meta property="twitter:description" content="Resulta que hoy en la noche estamos en la comunidad conversando y de momento uno de los miembros...">
<meta property="twitter:image" content="https://images.ecency.com/DQmUytfbt6r8qGgvKhBLQwehcj7aPA23VVuFXQk8PHq95Gw/istock_962366210.png">
  <link rel="stylesheet" href="/_astro/404.64ba6a26.css" />
<link rel="stylesheet" href="/_astro/_slug_.af480368.css" /><script type="module">const n=document.getElementById("home"),c=document.getElementById("projects"),o=document.getElementById("services"),d=document.getElementById("resources"),i=document.getElementById("blog"),l=document.getElementById("cv");var t=!0;const m=window.location.href,r=[c,o,d,i,l],s="bg-base-300";r.forEach(e=>{e?.id&&m.includes(e.id)&&(t=!1,e?.classList.add(s))});t&&n?.classList.add(s);
</script></head>
  <body>
    <div class="bg-base-100 drawer drawer-mobile">
      <input id="my-drawer" type="checkbox" class="drawer-toggle">
      <div class="drawer-content flex flex-col bg-base-100">
        <div class="sticky lg:hidden top-0 z-30 flex h-16 w-full justify-center bg-opacity-90 backdrop-blur transition-all duration-100 bg-base-100 text-base-content shadow-sm">
  <div class="navbar">
    <div class="navbar-start">
      <label for="my-drawer" class="btn btn-square btn-ghost">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-5 h-5 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </label>
    </div>
    <div class="navbar-center">
      <a class="btn btn-ghost normal-case text-xl" href="/">Saqib Safdar ⚡️</a>
    </div>
    <div class="navbar-end"></div>
  </div>
</div>
        <div class="md:flex md:justify-center">
          <main class="p-6 pt-10 max-w-[900px]">
            
  <main class="md:flex md:justify-center">
    <article class="prose prose-lg max-w-[750px] prose-img:mx-auto">
      <img alt="Como hakearon las llaves privadas de un amigo directamente de Metamask y que hacer para que no te ocurra." class="w-full mb-6" width="750" height="422" src="/_astro/istock_962366210_2rgzWd.webp" loading="lazy" decoding="async">
      <h1 class="title my-2 text-4xl font-bold">Como hakearon las llaves privadas de un amigo directamente de Metamask y que hacer para que no te ocurra.</h1>
      <time>Jun 4, 2022</time>
      <br>
      
      
      <div class="divider my-2"></div>
      
    <p>Resulta que hoy en la noche estamos en la comunidad conversando y de momento uno de los miembros nos dice sin más que le hackearon la billetera Metamask.</p>
<p><img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1654316018274/GITJ3tjU6.png" alt="Screenshot from 2022-06-03 23-46-16.png"></p>
<p>Insider nos cuenta que estaba descargando un crack para una aplicación de diseño que necesitaba utilizar. La bajo y la empleo a unque según dice algo le daba mala espina. Al cabo del tiempo, sin siquiera haber abierto la billetera ese día le llega una notificación diciéndole había realizado una transferencia, en ese momento callo en la cuenta de que evidentemente ese crack que había bajado estaba comprometido y de alguna manera por ahí le había hackeado la wallet.</p>
<p>Estuvimos hablando un rato en la comunidad tratando de entender que había pasado, aunque al inicio no entendíamos que podía haber sido, él no tiene físicamente las claves en la PC por lo que descartaba que el virus hubiera registrado los ficherons en busca de las llave. Tampoco había abierto Metamask ese día por lo que tampoco se trataba de un Keylogger (Un virus que captura lo que tecleamos) y si así lo fuera esa contraseña es solo de Metamask le seguían faltando las llaves.</p>
<h2 id="investigación-de-lo-ocurrido">Investigación de lo ocurrido</h2>
<p>Resulta que cuando creamos nuestra cuenta de Metamask en nuestro navegador, este cifra y almacena nuestras llaves privadas de manera local. Esta información se almacena en un fichero físico al cual se puede <a href="https://ethereum.stackexchange.com/questions/52658/where-does-metamask-store-the-wallet-seed-file-path">acceder desde la pc</a> o desde <a href="https://github.com/MetaMask/metamask-extension/issues/2749">local-storage del navegador web</a>.</p>
<p><img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1654317153548/ELap0daBj.png" alt="Screenshot from 2022-06-03 23-48-37.png"></p>
<p><img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1654317304353/8SzsUI3v8.png" alt="Screenshot from 2022-06-03 23-22-49.png"></p>
<p>La información que tiene este registro está cifrada con la contraseña con que inicialmente configuramos Metamask, por lo que con tener ese fichero no es suficiente para robar nuestras llaves, también necesita de esta contraseña.</p>
<p>Al parecer, por cuestiones de seguridad para recuperar las llaves Metamask tiene <a href="https://github.com/MetaMask/vault-decryptor">una herramienta</a> de código abierto a la que le puedes pasar el bloque de información cifrado y la contraseña y puedes obtener las llaves privadas.</p>
<p><img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1654318755522/j74AS9-t4.png" alt="Screenshot from 2022-06-03 23-51-57.png"></p>
<p>Al esta herramienta ser de código abierto es muy sencillo descargarla y modificar su código, por lo que fácilmente podríamos hacer un ataque de fuerza bruta o con un diccionario que itere intentando romper la contraseña del fichero y en caso de la contraseña no ser muy fuerte podemos obtener las llaves privadas.</p>
<p>Aquí tiene las páginas de las que bajo el crack y como estas hay muchas otras donde casi siempre los cracks o aplicaciones crackeadas están comprometidas.</p>
<p><img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1654318899263/upoScm1ee.png" alt="Screenshot from 2022-06-04 01-01-18.png"></p>
<p>Esta es la wallet a la que el atacante envió los tokens que robó de la billetera. Al parecer muchos otros han caído en lo mismo, ya que el valor de la billetera es de 10 mil dólares.</p>
<p><img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1654318961260/AS-RCXAtH.jpg" alt="photo_2022-06-03_22-35-59.jpg"></p>
<h2 id="veredicto">Veredicto</h2>
<p>Toda esta información es la que nos lleva a deducir que el crack que descargó contenía un troyano que accedió a esos ficheros de Metamask y los envió al atacante. La contraseña que tenía en Metamask no era muy fuerte (yo mismo tampoco tengo una muy fuerte, ya que al final a esa extensión solo se puede acceder de forma local) y al atacante tener en sus manos el fichero con un ataque de fuerza bruta, logro descifrar el archivo, acceder a las llaves privadas y con esto a la wallet.</p>
<h2 id="consejos">Consejos</h2>
<p>De lo ocurrido podemos sacar varias recomendaciones para que no nos ocurra lo mismo:</p>
<ul>
<li>Evitar descargar cracks o aplicaciones crackeadas ya pueden estar comprometidas.</li>
<li>Tener siempre un antivirus si vamos a navegar por internet y más si te vas a meter en sitios raros.</li>
<li>Metamask almacena nuestras llaves privadas de manera local y aunque estén cifradas están ahí, por lo que si lo vamos a utilizar tenemos que ponerle una contraseña fuerte para evitar que accedan a nuestras llaves.</li>
</ul>
<h2 id="conclusión">Conclusión</h2>
<p>Luego de haber visto este caso me queda un sabor bien amargo respecto a como las wallets manejan nuestras llaves, nunca pensé que Metamask almacenara las llaves en nuestra PC, entiendo que lo hace como mecanismo de recuperación, pero me parece inapropiado sobre todo cuando esto es lo primero que se dice que no se debe hacer. Ahora me surgen las dudas de como funcionara la aplicación Movil y si tiene este mismo problema  o como funcionaran las demás wallets donde almacenamos nuestros tokens. Por mi parte, procuraré poner contraseñas bien fuertes (aunque esto no es infalible porque si combinan el ataque con un keylogger la pueden capturar) y si es posible investigar bien una billetera y sus mecanismos de seguridad antes de emplearla.</p>

    </article>
  </main>

          </main>
        </div>
        <footer class="footer footer-center block mb-5 pt-10">
  <div class="pb-2">
    &copy; 2025 Saqib Safdar
  </div>
  <div class="inline opacity-75">
    <!-- Thanks for using this template. Please keep this line to support my work :) -->
    <a href="https://astro-modern-personal-website.netlify.app/" target="_blank" class="font-bold">Website Template</a> developed by
    <a href="https://manuelernestog.github.io" target="_blank" class="font-bold">Saqib Safdar ⚡️</a>
  </div>
</footer>
      </div>
      <div class="drawer-side bg-base-200">
  <label for="my-drawer" class="drawer-overlay bg-base-200"></label>
  <div class="menu flex flex-col flex-nowrap p-4 overflow-y-auto w-[19rem] bg-base-200 text-base-content">
    <div class="w-fit">
      <a href="/">
        <div class="avatar transition ease-in-out w-1/2 hover:scale-[102%] block m-auto mt-3 mb-6 h-36">
          <div>
            <img class="mask mask-circle" alt="Profile image" width="300" height="300" src="/_astro/profile_Z1AnH13.webp" loading="lazy" decoding="async">
          </div>
        </div>
      </a>
    </div>
    <ul class="grow shrink">
      <!-- Sidebar content here -->
      <li><a id="home" href="/">Home</a></li>
      <li><a id="projects" href="/projects">Projects</a></li>
      <li><a id="resources" href="/resources">Resources</a></li>
      <li><a id="blog" href="/blog/">Blog</a></li>
      <li><a id="cv" href="/cv">CV</a></li>
      <li><a href="mailto:contact.manuelernestog@gmail.com">Contact</a></li>
    </ul>
    <div class="social-icons px-4 my-2 flex self-center">
      <a href="/support-my-work" class="mx-3" aria-label="Support my work" title="Support my work">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: currentColor;transform: ;msFilter:;"><path fill-rule="evenodd" clip-rule="evenodd" d="M5 2h2v3H5zm4 0h2v3H9zm4 0h2v3h-2zm6 7h-2V7H3v11c0 1.654 1.346 3 3 3h8c1.654 0 3-1.346 3-3h2c1.103 0 2-.897 2-2v-5c0-1.103-.897-2-2-2zm-4 9a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V9h10v9zm2-2v-5h2l.002 5H17z"></path></svg>
      </a>
      <a href="https://github.com/manuelernestog" target="_blank" class="mx-3" aria-label="Github" title="Github">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: currentColor;transform: ;msFilter:;"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.026 2c-5.509 0-9.974 4.465-9.974 9.974 0 4.406 2.857 8.145 6.821 9.465.499.09.679-.217.679-.481 0-.237-.008-.865-.011-1.696-2.775.602-3.361-1.338-3.361-1.338-.452-1.152-1.107-1.459-1.107-1.459-.905-.619.069-.605.069-.605 1.002.07 1.527 1.028 1.527 1.028.89 1.524 2.336 1.084 2.902.829.091-.645.351-1.085.635-1.334-2.214-.251-4.542-1.107-4.542-4.93 0-1.087.389-1.979 1.024-2.675-.101-.253-.446-1.268.099-2.64 0 0 .837-.269 2.742 1.021a9.582 9.582 0 0 1 2.496-.336 9.554 9.554 0 0 1 2.496.336c1.906-1.291 2.742-1.021 2.742-1.021.545 1.372.203 2.387.099 2.64.64.696 1.024 1.587 1.024 2.675 0 3.833-2.33 4.675-4.552 4.922.355.308.675.916.675 1.846 0 1.334-.012 2.41-.012 2.737 0 .267.178.577.687.479C19.146 20.115 22 16.379 22 11.974 22 6.465 17.535 2 12.026 2z"></path>
        </svg>
      </a>
      <a href="https://twitter.com/manuelernestog" target="_blank" class="mx-3" aria-label="Twitter" title="Twitter">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: currentColor;transform: ;msFilter:;"><path d="M19.633 7.997c.013.175.013.349.013.523 0 5.325-4.053 11.461-11.46 11.461-2.282 0-4.402-.661-6.186-1.809.324.037.636.05.973.05a8.07 8.07 0 0 0 5.001-1.721 4.036 4.036 0 0 1-3.767-2.793c.249.037.499.062.761.062.361 0 .724-.05 1.061-.137a4.027 4.027 0 0 1-3.23-3.953v-.05c.537.299 1.16.486 1.82.511a4.022 4.022 0 0 1-1.796-3.354c0-.748.199-1.434.548-2.032a11.457 11.457 0 0 0 8.306 4.215c-.062-.3-.1-.611-.1-.923a4.026 4.026 0 0 1 4.028-4.028c1.16 0 2.207.486 2.943 1.272a7.957 7.957 0 0 0 2.556-.973 4.02 4.02 0 0 1-1.771 2.22 8.073 8.073 0 0 0 2.319-.624 8.645 8.645 0 0 1-2.019 2.083z"></path>
        </svg>
      </a>
      <a href="https://www.linkedin.com/in/manuelernestogr" target="_blank" class="mx-3" aria-label="Linkedin" title="Linkedin">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: currentColor;transform: ;msFilter:;"><circle cx="4.983" cy="5.009" r="2.188"></circle><path d="M9.237 8.855v12.139h3.769v-6.003c0-1.584.298-3.118 2.262-3.118 1.937 0 1.961 1.811 1.961 3.218v5.904H21v-6.657c0-3.27-.704-5.783-4.526-5.783-1.835 0-3.065 1.007-3.568 1.96h-.051v-1.66H9.237zm-6.142 0H6.87v12.139H3.095z"></path>
        </svg>
      </a>

      <a href="/rss.xml" target="_blank" class="mx-3" aria-label="RSS Feed" title="RSS Feed">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: currentColor;transform: ;msFilter:;"><path d="M19 20.001C19 11.729 12.271 5 4 5v2c7.168 0 13 5.832 13 13.001h2z"></path><path d="M12 20.001h2C14 14.486 9.514 10 4 10v2c4.411 0 8 3.589 8 8.001z"></path><circle cx="6" cy="18" r="2"></circle>
        </svg>
      </a>
    </div>
  </div>
</div>
    </div>
  </body>
</html>